INSERT INTO Analysis ( CampaignType, Campaign, AdGroup, Status, Now_Cost, Prev_Cost, CostChange, Now_Conversions, Prev_Conversions, ConvChange, Now_CostPerConv, Prev_CostPerConv, CPA_Change, Now_Revenue, Prev_Revenue, RevenueChange, Now_NetProfit, Prev_NetProfit, NetChange, Now_CTR, Prev_CTR, CTRChange, Now_AvgCPC, Prev_AvgCPC, AvgCPCChange, Now_BounceRate, Prev_BounceRate, BounceRateChange )
SELECT NowDisplay.CampaignType AS CampaignType, NowDisplay.Campaign, NowDisplay.AdGroup, NowDisplay.Status, Sum(NowDisplay.Cost) AS Now_Cost, Sum(PrevDisplay.Cost) AS Prev_Cost, [Now_Cost]-[Prev_Cost] AS CostChange, Sum(NowDisplay.Conversions) AS NowConversions, Sum(PrevDisplay.Conversions) AS PrevConversions, [NowConversions]-[PrevConversions] AS ConvChange, Sum(NowDisplay.CPA) AS Now_CPA, Sum(PrevDisplay.CPA) AS Prev_CPA, [Now_CPA]-[Prev_CPA] AS CPAChange, Sum(NowDisplay.GP) AS Now_GP, Sum(PrevDisplay.GP) AS Prev_GP, [Now_GP]-[Prev_GP] AS RevChange, [Now_GP]-[Now_Cost] AS Now_NetProfit, [Prev_GP]-[Prev_Cost] AS Prev_NetProfit, [Now_NetProfit]-[Prev_NetProfit] AS NetChange, Avg(NowDisplay.CTR) AS Now_CTR, Avg(PrevDisplay.CTR) AS Prev_CTR, [Now_CTR]-[Prev_CTR] AS CTRChange, Avg(NowDisplay.AvgCPC) AS Now_AvgCPC, Avg(PrevDisplay.AvgCPC) AS Prev_AvgCPC, [Now_AvgCPC]-[Prev_AvgCPC] AS AvgCPCChange, Avg(NowDisplay.BounceRate) AS Now_BounceRate, Avg(PrevDisplay.BounceRate) AS Prev_BounceRate, [Now_BounceRate]-[Prev_BounceRate] AS BounceRateChange
FROM PrevDisplay INNER JOIN (NowDisplay INNER JOIN CombinedIDs ON (NowDisplay.AdGroupID = CombinedIDs.AdgroupID)) ON  (PrevDisplay.AdGroupID = CombinedIDs.AdgroupID)
GROUP BY NowDisplay.CampaignType, NowDisplay.Campaign, NowDisplay.AdGroup, NowDisplay.Status;
