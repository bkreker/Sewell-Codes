var PreviewMsg="",EMAIL_SIGNATURE=function(){const t="\n\nThis report was created by an automatic script by Josh DeGraw. If there are any errors or questions about this report, please inform me as soon as possible.";return t},IS_PREVIEW=AdWordsApp.getExecutionInfo().isPreview(),_={getDateTime:function(){try{var t=new Date,e=AdWordsApp.currentAccount().getTimeZone(),r="MM-dd-yyyy",a=Utilities.formatDate(t,e,r),o=AM_PM(t),n={day:a,time:o};return n}catch(t){throw error("_getDateTime()",t)}},AM_PM:function(t){try{var e=t.getHours()+1,r=t.getMinutes(),a=e>=12?"pm":"am";e%=12,e=e?e:12,r=r<10?"0"+r:r;var o=e+":"+r+" "+a;return o}catch(e){throw error("AM_PM(date: "+t+")",e)}},CustomDateRange:function(t,e,r){try{null!==t&&void 0!==t||(t=91),null!==e&&void 0!==e||(e=0),void 0!==r&&""!==r&&null!==r||(r="YYYYMMdd");var a=_daysAgo(t),o=_daysAgo(e),n=_daysAgo(t,r).toString(),i=_daysAgo(e,r).toString(),s=n+","+i,c={fromStr:n,toStr:i,fromObj:a,toObj:o,dateObj:[a,o],string:s};return c}catch(a){throw error("CustomDateRange(fromDaysAgo: "+t+", tillDate: "+e+", format: "+r+")",a)}},daysAgo:function(t,e){try{var r=new Date;r.setDate(r.getDate()-t);var a;if(void 0!=e&&""!=e&&null!=e){var o=AdWordsApp.currentAccount().getTimeZone();a=Utilities.formatDate(r,o,e)}else a={year:r.getYear(),month:r.getMonth(),day:r.getDate()};return a}catch(r){throw error("_daysAgo(num: "+t+", format: "+e+")",r)}},today:function(t){try{var e,r=new Date,a=AdWordsApp.currentAccount().getTimeZone();return e=void 0!=t&&""!=t&&null!=t?Utilities.formatDate(r,a,t):{day:r.getDate(),month:r.getMonth(),year:r.getYear(),time:r.getTime()}}catch(e){throw error("_today(format: "+t+")",e)}},getDateString:function(){try{var t=new Date,e=AdWordsApp.currentAccount().getTimeZone(),r="MM-dd-yyyy",a=Utilities.formatDate(t,e,r);return a}catch(t){throw error("_getDateString()",t)}},todayIsMonday:function(){try{var t=36e5,e=new Date,r=new Date(e.getTime()+t),a=(r.getTime(),r.getDay());return Logger.log("today: "+r+"\nday: "+a),1===a}catch(t){throw error("todayIsMonday",t)}},rolling13Week:function(t){try{void 0!==t&&""!==t&&null!==t||(t="YYYYMMdd");var e=CustomDateRange(98,8,t),r=CustomDateRange(91,1,t),a=e.string+" - "+r.string,o={from:e,to:r,string:a};return o}catch(e){throw error("Rolling13Week(format: "+t+")",e)}},formatKeyword:function(t){try{return t=t.replace(/[^a-zA-Z0-9 ]/g,"")}catch(e){throw error("formatKeyword(keyword: "+t+")",e)}},round:function(t){try{var e=Math.pow(10,DECIMAL_PLACES);return Math.round(t*e)/e}catch(e){throw error("round(value: "+t+")",e)}},getStandardDev:function(t,e,r){try{var a=0;for(var o in t)a+=Math.pow(t[o].stats[r]-e,2);return 0==Math.sqrt(t.length-1)?0:round(Math.sqrt(a)/Math.sqrt(t.length-1))}catch(a){throw error("getStandardDev(entites: "+t+", mean: "+e+", stat_key: "+r+")",a)}},getMean:function(t,e){try{var r=0;for(var a in t)r+=t[a].stats[e];return 0==t.length?0:round(r/t.length)}catch(r){throw error("getMean(entites: "+t+", stat_key: "+e+")",r)}},createLabelIfNeeded:function(t){try{AdWordsApp.labels().withCondition("Name = '"+t+"'").get().hasNext()||AdWordsApp.createLabel(t)}catch(e){throw error("createLabelIfNeeded(name: "+t+")",e)}},EmailErrorReport:function(t,e,r,a,o){var n="AdWords Alert: Error in "+t+", script "+(o?"did execute correctly ":"did not execute ")+" correctly.",i="Error on line "+a.lineNumber+":\n"+a.message+EMAIL_SIGNATURE(),s=emailAttachment(),c=_getDateString()+"_"+t,l=r?e[0]:e.join();PreviewMsg=r?"Preview; No changes actually made.\n":"",""!=i&&MailApp.sendEmail({to:l,subject:n,body:PreviewMsg+i,attachments:[{fileName:c+".csv",mimeType:"text/csv",content:s}]}),print("Email sent to: "+l)},sendResultsViaEmail:function(t,e){try{var r,a=t.match(/\n/g).length-1,o=_getDateTime().day,n="AdWords Alert: "+SCRIPT_NAME.join(" ")+" "+_titleCase(e)+"s Report - "+day,i="\n\nThis report was created by an automatic script by Josh DeGraw. If there are any errors or questions about this report, please inform me as soon as possible.",s=emailMessage(a)+i,c=SCRIPT_NAME.join("_")+o,l="";0!=a&&(AdWordsApp.getExecutionInfo().isPreview()?(r=EMAILS[0],l="Preview; No changes actually made.\n"):r=EMAILS.join(),MailApp.sendEmail({to:r,subject:n,body:l+s,attachments:[Utilities.newBlob(t,"text/csv",c+o+".csv")]}),Logger.log("Email sent to: "+r))}catch(r){throw error("sendResultsViaEmail(report: "+t+", level: "+e+")",r)}},titleCase:function(t){try{return t.replace(/(?:^|\s)\S/g,function(t){return t.toUpperCase()})}catch(e){throw error("_titleCase(str: "+t+")",e)}},EmailResults:function(t){try{var e,r=EMAILS,a="AdWords Alert: "+t.join(" "),o=emailMessage()+EMAIL_SIGNATURE(),n=emailAttachment(),i=_getDateString()+"_"+t.join("_"),s="";e=IS_PREVIEW?r[0]:r.join(),PreviewMsg=IS_PREVIEW?"Preview; No changes actually made.\n":"",""!=o&&MailApp.sendEmail({to:e,subject:a,body:s+o,attachments:[{fileName:i+".csv",mimeType:"text/csv",content:n}]}),print("Email sent to: "+e)}catch(e){throw error("EmailResults(ReportName: "+t.join(" ")+")",e)}},EmailReportResults:function(t,e,r,a){try{var o,n="AdWords Alert: "+e.join(" "),i=_getDateString()+"_"+e.join("_");o=IS_PREVIEW?t[0]:t.join(),PreviewMsg=IS_PREVIEW?"Preview; No changes actually made.\n":"",""!=r&&MailApp.sendEmail({to:o,subject:n,body:PreviewMsg+r+EMAIL_SIGNATURE(),attachments:[{fileName:i+".csv",mimeType:"text/csv",content:a.join(",")}]}),Logger.log("Email sent to: "+To)}catch(r){print(a.join()),error("EmailReportResults(_emails: "+t.join()+", _reportName:"+e.join()+", _message, _attachment),\n"+r)}},info:function(t){Logger.log(t)},print:function(t){Logger.log(t)},error:function(t,e){var r=e.name+" in "+t+" at line "+e.lineNumber+": "+e.message;return Logger.log(r),r},warn:function(t){Logger.log("WARNING: "+t)},isNumber:function(t){try{return t.toString().match(/(\.*([0-9])*\,*[0-9]\.*)/g)||NaN===t}catch(e){throw error("isNumber(obj: "+t+")",e)}},hasLabelAlready:function(t,e){try{return t.labels().withCondition("Name = '"+e+"'").get().hasNext()}catch(r){throw error("hasLabelAlready(entity: "+t+", label"+e+")",r)}}};