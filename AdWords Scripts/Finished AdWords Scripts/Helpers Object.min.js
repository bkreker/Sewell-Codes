var _={getDateTime:function(){try{var t=new Date,e=AdWordsApp.currentAccount().getTimeZone(),r="MM-dd-yyyy",a=Utilities.formatDate(t,e,r),o=AM_PM(t),n={day:a,time:o};return n}catch(t){throw error("getDateTime()",t)}},AM_PM:function(t){try{var e=t.getHours()+1,r=t.getMinutes(),a=e>=12?"pm":"am";e%=12,e=e?e:12,r=r<10?"0"+r:r;var o=e+":"+r+" "+a;return o}catch(e){throw error("AM_PM(date: "+t+")",e)}},CustomDateRange:function(t,e,r){try{null!==t&&void 0!==t||(t=91),null!==e&&void 0!==e||(e=0),void 0!==r&&""!==r&&null!==r||(r="YYYYMMdd");var a=daysAgo(t),o=daysAgo(e),n=daysAgo(t,r).toString(),i=daysAgo(e,r).toString(),s=[a,o],c=n+","+i,g={fromStr:n,toStr:i,fromObj:a,toObj:o,dateObj:s,string:c};return g}catch(a){throw error("CustomDateRange(fromDaysAgo: "+t+", tillDate: "+e+", format: "+r+")",a)}},daysAgo:function(t,e){try{var r=new Date;r.setDate(r.getDate()-t);var a;if(void 0!=e&&""!=e&&null!=e){var o=AdWordsApp.currentAccount().getTimeZone();a=Utilities.formatDate(r,o,e)}else a={day:r.getDate(),month:r.getMonth(),year:r.getYear()};return a}catch(r){throw error("daysAgo(num: "+t+", format: "+e+")",r)}},today:function(t){try{var e,r=new Date,a=AdWordsApp.currentAccount().getTimeZone();return e=void 0!=t&&""!=t&&null!=t?Utilities.formatDate(r,a,t):{day:r.getDate(),month:r.getMonth(),year:r.getYear(),time:r.getTime()}}catch(e){throw error("today(format: "+t+")",e)}},getDateString:function(){try{var t=new Date,e=AdWordsApp.currentAccount().getTimeZone(),r="MM-dd-yyyy",a=Utilities.formatDate(t,e,r);return a}catch(t){throw error("getDateString()",t)}},todayIsMonday:function(){try{var t=36e5,e=new Date,r=new Date(e.getTime()+t),a=(r.getTime(),r.getDay());return Logger.log("today: "+r+"\nday: "+a),1===a}catch(t){throw error("todayIsMonday",t)}},rolling13Week:function(t){try{void 0!==t&&""!==t&&null!==t||(t="YYYYMMdd");var e=CustomDateRange(98,8,t),r=CustomDateRange(91,1,t),a=e.string+" - "+r.string,o={from:e,to:r,string:a};return o}catch(e){throw error("Rolling13Week(format: "+t+")",e)}},formatKeyword:function(t){try{return t=t.replace(/[^a-zA-Z0-9 ]/g,"")}catch(e){throw error("formatKeyword(keyword: "+t+")",e)}},round:function(t){try{var e=Math.pow(10,DECIMAL_PLACES);return Math.round(t*e)/e}catch(e){throw error("round(value: "+t+")",e)}},getStandardDev:function(t,e,r){try{var a=0;for(var o in t)a+=Math.pow(t[o].stats[r]-e,2);return 0==Math.sqrt(t.length-1)?0:round(Math.sqrt(a)/Math.sqrt(t.length-1))}catch(a){throw error("getStandardDev(entites: "+t+", mean: "+e+", stat_key: "+r+")",a)}},getMean:function(t,e){try{var r=0;for(var a in t)r+=t[a].stats[e];return 0==t.length?0:round(r/t.length)}catch(r){throw error("getMean(entites: "+t+", stat_key: "+e+")",r)}},createLabelIfNeeded:function(t){try{AdWordsApp.labels().withCondition("Name = '"+t+"'").get().hasNext()||AdWordsApp.createLabel(t)}catch(e){throw error("createLabelIfNeeded(name: "+t+")",e)}},sendResultsViaEmail:function(t,e){try{var r,a=t.match(/\n/g).length-1,o=getDateTime().day,n="AdWords Alert: "+SCRIPT_NAME.join(" ")+" "+titleCase(e)+"s Report - "+day,i="\n\nThis report was created by an automatic script by Josh DeGraw. If there are any errors or questions about this report, please inform me as soon as possible.",s=emailMessage(a)+i,c=SCRIPT_NAME.join("_")+o,g="";0!=a&&(AdWordsApp.getExecutionInfo().isPreview()?(r=EMAILS[0],g="Preview; No changes actually made.\n"):r=EMAILS.join(),MailApp.sendEmail({to:r,subject:n,body:g+s,attachments:[Utilities.newBlob(t,"text/csv",c+o+".csv")]}),Logger.log("Email sent to: "+r))}catch(r){throw error("sendResultsViaEmail(report: "+t+", level: "+e+")",r)}},titleCase:function(t){try{return t.replace(/(?:^|\s)\S/g,function(t){return t.toUpperCase()})}catch(e){throw error("_titleCase(str: "+t+")",e)}},EmailResults:function(t){try{var e,r="AdWords Alert: "+t.join(" "),a="\n\nThis report was created by an automatic script by Josh DeGraw. If there are any errors or questions about this report, please inform me as soon as possible.",o=emailMessage()+a,n=emailAttachment(),i=getDateString()+"_"+t.join("_"),s="";AdWordsApp.getExecutionInfo().isPreview()?(e=EMAILS[0],s="Preview; No changes actually made.\n"):e=EMAILS.join(),""!=o&&MailApp.sendEmail({to:e,subject:r,body:o,attachments:[{fileName:i+".csv",mimeType:"text/csv",content:n}]}),Logger.log("Email sent to: "+e)}catch(e){throw error("EmailResults(ReportName: "+t+")",e)}},info:function(t){Logger.log(t)},print:function(t){Logger.log(t)},error:function(t,e){var r="ERROR in "+t+": "+e;return Logger.log(r),r},warn:function(t){Logger.log("WARNING: "+t)},isNumber:function(t){try{return t.toString().match(/(\.*([0-9])*\,*[0-9]\.*)/g)||NaN===t}catch(e){throw error("isNumber(obj: "+t+")",e)}},hasLabelAlready:function(t,e){try{return t.labels().withCondition("Name = '"+e+"'").get().hasNext()}catch(r){throw error("hasLabelAlready(entity: "+t+", label"+e+")",r)}}};