SELECT NowShopping.Campaign, NowShopping.AdGroup, Sum(NowShopping.Cost) AS Now_Cost, Sum(PrevShopping.Cost) AS Prev_Cost, [Now_Cost]-[Prev_Cost] AS CostChange, Sum(NowShopping.Revenue) AS Now_AllConvValue, Sum(NowShopping.Revenue) AS Prev_AllConvValue, [Now_AllConvValue]-[Prev_AllConvValue] AS ConvChange, [Now_AllConvValue]-[Now_Cost] AS NowShopping_NetProfit, [Prev_AllConvValue]-[Prev_Cost] AS PrevShopping_NetProfit, [NowShopping_NetProfit]-[PrevShopping_NetProfit] AS NetChange, Avg(NowShopping.CTR) AS Now_CTR, Avg(PrevShopping.CTR) AS Prev_CTR, [Now_CTR]-[Prev_CTR] AS CTRChange, Avg(NowShopping.AvgCPC) AS Now_AvgCPC, Avg(PrevShopping.AvgCPC) AS Prev_AvgCPC, [Now_AvgCPC]-[Prev_AvgCPC] AS AvgCPCChange
FROM NowShopping INNER JOIN PrevShopping ON (NowShopping.AdGroupID = PrevShopping.AdGroupID) AND (NowShopping.CampaignID = PrevShopping.CampaignID)
GROUP BY NowShopping.Campaign, NowShopping.AdGroup;
